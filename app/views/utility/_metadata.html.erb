<script type='text/javascript'>
  window.sonar = {};

  sonar.chrome_app_id = '<%= Rails.configuration.properties['chrome_app_id'] %>';

  sonar.request = {
    controller: '<%= request.params[:controller] %>',
    action: '<%= request.params[:action] %>',
    page: <%= @page || 0 %>
  };

  <% if protect_against_forgery? %>
    window.AUTH_TOKEN = '<%= form_authenticity_token %>';
  <% end %>

  <% if current_researcher %>
    sonar.user = {
      hashid: '<%= current_researcher.hashid %>'
    };
  <% end %>

  <% if @scenario %>
    sonar.scenario = <%= raw @scenario.prezi.public_json.to_json %>;
  <% end %>

  <% if @template %>
    sonar.template = <%= raw @template.prezi.public_json.to_json %>;
  <% end %>

  <% if @scenario_result %>
    sonar.scenarioResult = <%= raw @scenario_result.prezi.public_json.to_json %>;
  <% end %>

  <% if @scenario_highlight %>
    sonar.scenarioHighlight = <%= raw @scenario_highlight.prezi.public_json.to_json %>
  <% end %>

</script>
