<script type='text/javascript'>
  window.sonar = {};

  sonar.request = {
    controller: '<%= request.params[:controller] %>',
    action: '<%= request.params[:action] %>'
  };

  <% if current_researcher %>
  sonar.user = {
    hashid: '<%= current_researcher.hashid %>'
  };
  <% end %>

  <% if @scenario %>
    sonar.scenario = <%= raw @scenario.prezi.public_json.to_json %>;
  <% end %>

  <% if @template %>
    sonar.template = <%= raw @template.prezi.public_json.to_json %>;
  <% end %>

  <% if @result_step %>
  sonar.resultStep = <%= raw @result_step.prezi.public_json.to_json %>;
  <% end %>

  <% if @scenario_step %>
  sonar.scenarioStep = <%= raw @scenario_step.prezi.public_json.to_json %>;
  <% end %>

  <% if protect_against_forgery? %>
    window.AUTH_TOKEN = '<%= form_authenticity_token %>';
  <% end %>

  <% if @scenario_highlight %>
  sonar.scenarioHighlight = <%= raw @scenario_highlight.prezi.public_json.to_json %>
  <% end %>

</script>
